import{P as I}from"./PaginationView-2f713747.js";import{M as k}from"./bootstrap-c60aad6a.js";import{l,x as s,y as e,D as c,I as i,J as g,K as v,F as h,C as p,L as x,H as b,k as y,z as S,E as V}from"./@vue-26db76b7.js";import{_ as U}from"./index-358e5394.js";import"./axios-08622986.js";import"./vue-axios-58a7c26f.js";import"./@fortawesome-19f5c369.js";import"./vee-validate-b6132790.js";import"./@vee-validate-55db0f47.js";import"./vue-router-58c0efe5.js";const D={props:["productSelected","productIsNew","productCategories","addSideImages","saveProductChange","uploadImage"],data(){return{modal:""}},mounted(){this.modal=new k(this.$refs.modal,{keyboard:!1,backdrop:"static"})},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}}},A={class:"modal fade",id:"adminProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"adminProductModal",ref:"modal","aria-hidden":"true"},N={class:"modal-dialog modal-dialog-centered modal-xl",role:"document"},E={class:"modal-content"},L={class:"modal-header bg-warning bg-opacity-75"},T={class:"modal-title",id:"modalLabel"},B=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),O={class:"modal-body"},R={class:"row"},F={class:"col-sm-8",id:"edit-content-from"},H={class:"mb-3"},j=e("label",{for:"title",class:"form-label"},"產品名稱",-1),z={class:"row"},J={class:"mb-3 col-md-6"},K=e("label",{for:"main-category",class:"form-label"},"主分類",-1),q=e("option",{value:0,disabled:"",selected:""},"請選擇菜式",-1),G=["value"],Q={class:"mb-3 col-md-6"},W=e("label",{for:"price",class:"form-label"},"單位",-1),X={class:"row"},Y={class:"mb-3 col-md-6"},Z=e("label",{for:"area-category",class:"form-label"},"地域分類",-1),$=e("option",{value:0,disabled:"",selected:""},"請選擇地域",-1),ee=["value"],te={class:"mb-3 col-md-6"},oe=e("label",{for:"ingredient-category",class:"form-label"},"食材風格分類",-1),de=e("option",{value:0,disabled:"",selected:""},"請選擇食材",-1),le=["value"],se={class:"row"},ae={class:"mb-3 col-md-6"},ce=e("label",{for:"origin_price",class:"form-label"},"原價",-1),ie={class:"mb-3 col-md-6"},ne=e("label",{for:"price",class:"form-label"},"售價",-1),re={class:"mb-3"},ue=e("label",{for:"description",class:"form-label"},"內容描述",-1),me={class:"mb-3"},ge=e("label",{for:"content",class:"form-label"},"說明內容",-1),he={class:"mb-3"},_e={class:"form-check"},be=e("label",{class:"form-check-label",for:"is_enabled"},"是否上架",-1),pe={class:"col-sm-4"},fe={class:"mb-3"},ve=e("label",{for:"imageUrl ",class:"form-label"},"主圖(請輸入網址或上傳圖片)",-1),ye=["src"],Se=e("hr",null,null,-1),Pe={key:0},Ue={class:"mb-3"},Ce=e("label",{for:"imageUrl",class:"form-label"},"副圖網址：",-1),ke=["onUpdate:modelValue"],we=["src"],Me=["onClick"],Ie=e("hr",null,null,-1),xe={key:0},Ve={class:"modal-footer"},De={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"};function Ae(a,o,t,r,m,n){return l(),s("div",A,[e("div",N,[e("div",E,[e("div",L,[e("h5",T,c(t.productIsNew?"新增產品":"編輯產品"),1),B]),e("div",O,[e("div",R,[e("div",F,[e("div",H,[j,i(e("input",{id:"title","onUpdate:modelValue":o[0]||(o[0]=d=>t.productSelected.title=d),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[g,t.productSelected.title]])]),e("div",z,[e("div",J,[K,i(e("select",{id:"main-category",class:"form-select","aria-label":"select main-category","onUpdate:modelValue":o[1]||(o[1]=d=>t.productSelected.category=d)},[q,(l(!0),s(h,null,p(t.productCategories.mainCategories,d=>(l(),s("option",{key:d,value:d},c(d),9,G))),128))],512),[[v,t.productSelected.category]])]),e("div",Q,[W,i(e("input",{id:"unit","onUpdate:modelValue":o[2]||(o[2]=d=>t.productSelected.unit=d),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[g,t.productSelected.unit]])])]),e("div",X,[e("div",Y,[Z,i(e("select",{id:"area-category",class:"form-select","aria-label":"select area-category","onUpdate:modelValue":o[3]||(o[3]=d=>t.productSelected.areaCategory=d)},[$,(l(!0),s(h,null,p(t.productCategories.areaCategories,d=>(l(),s("option",{key:d,value:d},c(d),9,ee))),128))],512),[[v,t.productSelected.areaCategory]])]),e("div",te,[oe,i(e("select",{id:"ingredient-category",class:"form-select","aria-label":"select ingredient-category","onUpdate:modelValue":o[4]||(o[4]=d=>t.productSelected.ingredientCategory=d)},[de,(l(!0),s(h,null,p(t.productCategories.ingredientCategories,d=>(l(),s("option",{key:d,value:d},c(d),9,le))),128))],512),[[v,t.productSelected.ingredientCategory]])])]),e("div",se,[e("div",ae,[ce,i(e("input",{id:"origin_price","onUpdate:modelValue":o[5]||(o[5]=d=>t.productSelected.origin_price=d),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[g,t.productSelected.origin_price,void 0,{number:!0}]])]),e("div",ie,[ne,i(e("input",{id:"price","onUpdate:modelValue":o[6]||(o[6]=d=>t.productSelected.price=d),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[g,t.productSelected.price,void 0,{number:!0}]])])]),e("div",re,[ue,i(e("textarea",{id:"description","onUpdate:modelValue":o[7]||(o[7]=d=>t.productSelected.description=d),type:"text",class:"form-control",placeholder:"請輸入產品描述，ex:內容物"},`
                `,512),[[g,t.productSelected.description]])]),e("div",me,[ge,i(e("textarea",{id:"content","onUpdate:modelValue":o[8]||(o[8]=d=>t.productSelected.content=d),type:"text",class:"form-control",placeholder:"請輸入說明內容"},`
                `,512),[[g,t.productSelected.content]])]),e("div",he,[e("div",_e,[i(e("input",{id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=d=>t.productSelected.is_enabled=d),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[x,t.productSelected.is_enabled]]),be])])]),e("div",pe,[e("div",fe,[ve,i(e("input",{"onUpdate:modelValue":o[10]||(o[10]=d=>t.productSelected.imageUrl=d),type:"text",class:"form-control my-2",placeholder:"請輸入圖片連結"},null,512),[[g,t.productSelected.imageUrl]]),e("input",{class:"form-control my-2",type:"file",name:"file-to-upload",onChange:o[11]||(o[11]=d=>t.uploadImage(d))},null,32),e("img",{class:"img-fluid rounded",src:t.productSelected.imageUrl},null,8,ye),t.productSelected.imageUrl?(l(),s(h,{key:0},[Se,Object.keys(t.productSelected).indexOf("imagesUrl")<0||!t.productSelected.imagesUrl.length?(l(),s("div",Pe,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100 mt-1",onClick:o[12]||(o[12]=(...d)=>t.addSideImages&&t.addSideImages(...d))}," 新增副圖 ")])):b("",!0)],64)):b("",!0)]),Array.isArray(t.productSelected.imagesUrl)&&t.productSelected.imagesUrl.length?(l(),s(h,{key:0},[(l(!0),s(h,null,p(t.productSelected.imagesUrl,(d,_)=>(l(),s("div",{class:"mb-1",key:"sideimage"+_},[e("div",Ue,[Ce,i(e("input",{"onUpdate:modelValue":f=>t.productSelected.imagesUrl[_]=f,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,ke),[[g,t.productSelected.imagesUrl[_]]])]),e("img",{class:"img-fluid rounded",src:d},null,8,we),t.productSelected.imagesUrl[t.productSelected.imagesUrl.length-1]?(l(),s("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100 m-1",onClick:f=>t.productSelected.imagesUrl.splice(_,1)}," 刪除本張副圖 ",8,Me)):b("",!0),Ie]))),128)),t.productSelected.imagesUrl[t.productSelected.imagesUrl.length-1]?(l(),s("div",xe,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100 m-1",onClick:o[13]||(o[13]=d=>t.productSelected.imagesUrl.push(""))}," 新增副圖 ")])):b("",!0)],64)):b("",!0)])])]),e("div",Ve,[e("button",De,c(t.productIsNew?"取消新增":"取消編輯"),1),e("button",{type:"button",class:"btn btn-warning",onClick:o[14]||(o[14]=d=>t.saveProductChange(t.productSelected.id))},c(t.productIsNew?"新增產品":"儲存變更"),1)])])])],512)}const Ne=U(D,[["render",Ae]]),Ee={props:["productSelected","delProduct"],data(){return{modal:""}},mounted(){this.modal=new k(this.$refs.modal,{keyboard:!1,backdrop:"static"})},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}}},Le={ref:"modal",class:"modal fade",id:"delProductModal",tabindex:"-1","aria-labelledby":"delProduct","aria-hidden":"true"},Te={class:"modal-dialog modal-dialog-centered"},Be={class:"modal-content"},Oe=e("div",{class:"modal-header bg-danger text-light"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"刪除產品"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Re={class:"modal-body"},Fe=e("p",null,"確認刪除商品：",-1),He={class:"m-0 fw-bold"},je={class:"fw-bold"},ze=e("strong",{class:"text-danger fs-6"},"＊產品經刪除後無法復原。",-1),Je={class:"modal-footer"},Ke=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function qe(a,o,t,r,m,n){return l(),s("div",Le,[e("div",Te,[e("div",Be,[Oe,e("div",Re,[e("div",null,[Fe,e("p",He,"產品名稱："+c(t.productSelected.title),1),e("p",je,"產品ＩＤ："+c(t.productSelected.id),1)]),ze]),e("div",Je,[Ke,e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=d=>t.delProduct(t.productSelected.id))}," 確定刪除 ")])])])],512)}const Ge=U(Ee,[["render",qe]]),{VITE_API_URL:Qe,VITE_API_PATH:We}={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_PATH:"kimi_project",BASE_URL:"/vue3-ECPlatform/week6-test/dist/",MODE:"production",DEV:!1,PROD:!0},C=`${Qe}api/${We}/admin`,Xe=`${C}/products`,P=`${C}/product`,Ye={data(){return{productCategories:{mainCategories:["主食","主菜","副菜","前菜冷盤","湯品","鍋物","甜點","點心","飲品","漬物乾貨"],areaCategories:["臺灣","亞洲","歐洲","美洲","非洲","大洋洲"],ingredientCategories:["地上跑的","土裡長的","搧翅膀的","水裡游的","湯湯水水","涮嘴小點","甜滋滋","喝起來"]},productsData:[],productsNum:0,productSelected:{imagesUrl:[]},productIsNew:!0,page:{}}},methods:{getAdminProductsData(a=1){const o=`${Xe}/?page=${a}`;this.$http.get(o).then(t=>{this.productsData=t.data.products,this.productsNum=this.productsData.length,this.page=t.data.pagination}).catch(t=>alert(t.response.data.message))},delProduct(a){const o=`${P}/${a}`;this.$http.delete(o).then(t=>{alert(t.data.message),this.$refs.delProductModal.hideModal(),this.getAdminProductsData()}).catch(t=>alert(t.response.data.message))},openModal(a,o){a==="add"?(this.productIsNew=!0,this.productSelected={imagesUrl:[],category:0,areaCategory:0,ingredientCategory:0},this.$refs.adminProductModal.openModal()):a==="edit"?(this.productSelected={...o},this.productIsNew=!1,this.$refs.adminProductModal.openModal()):a==="delete"&&(this.productSelected={...o},this.$refs.delProductModal.openModal())},uploadImage(a){const o=a.target.files[0],t=new FormData;t.append("file-to-upload",o),o&&this.$http.post(`${C}/upload`,t).then(r=>{this.productSelected.imageUrl=r.data.imageUrl}).catch(r=>alert(r.message))},addSideImages(){this.productSelected.imagesUrl=[],this.productSelected.imagesUrl.push("")},saveProductChange(a){const o=this.productIsNew?"post":"put",t=this.productIsNew?P:` ${P}/${a}`;this.$http[o](t,{data:this.productSelected}).then(r=>{alert(r.data.message),this.$refs.adminProductModal.hideModal(),this.getAdminProductsData()}).catch(r=>alert(r.message))}},components:{Pagination:I,AdminProductModal:Ne,DelProductModal:Ge},mounted(){this.getAdminProductsData()}},Ze={class:"text-end my-4"},$e={class:"table text-center"},et=e("thead",null,[e("tr",null,[e("th",{width:"10"},"序號"),e("th",{width:"70"},"分類"),e("th",{width:"120"},"產品名稱"),e("th",{width:"120"},"售價"),e("th",{width:"120"},"上架裝態"),e("th",{width:"120"},"編輯")])],-1),tt=["onClick"],ot=["onClick"];function dt(a,o,t,r,m,n){const d=y("Pagination"),_=y("AdminProductModal"),f=y("DelProductModal");return l(),s(h,null,[e("div",Ze,[e("button",{type:"button",class:"btn btn-warning",onClick:o[0]||(o[0]=u=>n.openModal("add"))}," 新增產品 ")]),e("table",$e,[et,e("tbody",null,[(l(!0),s(h,null,p(m.productsData,(u,w)=>(l(),s("tr",{key:u.id,class:"align-middle"},[e("td",null,c(w+1),1),e("td",null,c(u.category),1),e("td",null,c(u.title),1),e("td",null,c(u.price),1),e("td",{class:V({"text-success":u.is_enabled})},c(u.is_enabled?"啟用":"未啟用"),3),e("td",null,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm m-1",onClick:M=>n.openModal("edit",u)}," 編輯 ",8,tt),e("button",{type:" button",class:"btn btn-outline-danger btn-sm m-1",onClick:M=>n.openModal("delete",u)}," 刪除 ",8,ot)])]))),128))])]),S(d,{ref:"pagination",pages:m.page,"get-per-product":n.getAdminProductsData,onChangePage:n.getAdminProductsData},null,8,["pages","get-per-product","onChangePage"]),S(_,{ref:"adminProductModal","product-Selected":m.productSelected,"product-is-new":m.productIsNew,"product-categories":m.productCategories,"add-side-images":n.addSideImages,"save-product-change":n.saveProductChange,"upload-image":n.uploadImage},null,8,["product-Selected","product-is-new","product-categories","add-side-images","save-product-change","upload-image"]),S(f,{ref:"delProductModal","product-Selected":m.productSelected,"del-product":n.delProduct},null,8,["product-Selected","del-product"])],64)}const ht=U(Ye,[["render",dt]]);export{ht as default};
