import{b}from"./vue-router-58c0efe5.js";import{P as y}from"./PaginationView-2f713747.js";import{_ as P}from"./index-358e5394.js";import{k as l,l as r,x as n,y as t,F as h,C as D,z as p,D as c,A as x,B as C}from"./@vue-26db76b7.js";import"./axios-08622986.js";import"./vue-axios-58a7c26f.js";import"./@fortawesome-19f5c369.js";import"./vee-validate-b6132790.js";import"./@vee-validate-55db0f47.js";const{VITE_API_URL:g,VITE_API_PATH:m}={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_PATH:"kimi_project",BASE_URL:"/vue3-ECPlatform/week6-test/dist/",MODE:"production",DEV:!1,PROD:!0},v=`${g}/api/${m}/products`,_=`${g}/api/${m}/cart`,k={data(){return{productsData:[],productsNum:0,page:{},productSelected:"",cartData:[],cartTotalPrice:0,isLoading:!1,isCheckout:!1}},methods:{getProductsData(s=1){this.isLoading=!1;const o=`${v}/?page=${s}`;this.$http.get(o).then(a=>{this.productsData=a.data.products,this.productsNum=this.productsData.length,this.page=a.data.pagination}).catch(a=>alert(a.message))},getCartData(){this.cartTotalPrice=0,this.$http.get(_).then(s=>{this.isLoading=!1,this.cartData=s.data.data.carts,this.cartData.forEach(o=>{this.cartTotalPrice+=o.total})}).catch(s=>alert(s.message))},addToCart(s){if(s=this.checkCartItemQty(s),!s)return;const o={product_id:s,qty:1};this.isLoading=!0,this.$http.post(_,{data:o}).then(a=>{alert(a.data.message),this.getCartData()}).catch(a=>alert(a.message))},checkCartItemQty(s){const o=this.cartData.findIndex(a=>a.product.id===s);if(o<0||this.cartData[o].qty<=10)return s;alert("選購數量已超過上限，若有大量採購需求請另洽")}},components:{Pagination:y,RouterLink:b},mounted(){this.getProductsData(),this.getCartData()}},I={class:"row justify-content-between"},L={class:"col-md-8 m-0"},T=t("h4",null,"世界菜譜",-1),w={class:"row"},E={class:"card"},$=["src","alt"],V={class:"card-body"},A={class:"card-title"},R={class:"card-text"},U={class:"badge bg-secondary bg-opacity-75 text-body-emphasis me-2"},B={class:"badge bg-secondary bg-opacity-75 text-body-emphasis me-2"},N={class:"badge bg-secondary bg-opacity-75 text-body-emphasis me-2"},S={class:"card-text"},j={class:"text-decoration-line-through fw-light me-3"},q={class:"fw-semibold"},F={class:"card-footer"},H={class:"d-flex gap-1"},O=["onClick"],Q=t("div",{class:"col-md-3 m-0"},[t("h4",{class:"text-muted"},"尋找美味單"),t("span",{class:"text-muted"},"分類選單，先不做")],-1);function z(s,o,a,M,d,i){const u=l("RouterLink"),f=l("Pagination");return r(),n(h,null,[t("div",I,[t("div",L,[T,t("div",w,[(r(!0),n(h,null,D(d.productsData,e=>(r(),n("div",{class:"col-6 my-3",key:"productList"+e.id},[t("div",E,[t("img",{src:e.imageUrl,class:"card-img card-img-top rounded img-fluid object-fit-cover",alt:e.title,style:{height:"300px"}},null,8,$),t("div",V,[t("h5",A,c(e.title),1),t("p",R,[t("span",U,c(e.category),1),t("span",B,c(e.areaCategory),1),t("span",N,c(e.ingredientCategory),1)]),t("p",S,[t("span",j,"原價："+c(e.origin_price)+"元",1),t("span",q,"售價："+c(e.price)+"元",1)])]),t("div",F,[t("div",H,[p(u,{to:`product/${e.id}`,type:"button",class:"btn btn-sm btn-sm btn-outline-secondary w-100"},{default:x(()=>[C("查看產品細節 ")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-sm btn-sm btn-outline-warning w-100",onClick:G=>i.addToCart(e.id)}," 加入菜籃車 ",8,O)])])])]))),128))])]),Q]),p(f,{ref:"pagination",pages:d.page,"get-per-product":i.getProductsData,onChangePage:i.getProductsData},null,8,["pages","get-per-product","onChangePage"])],64)}const et=P(k,[["render",z]]);export{et as default};
