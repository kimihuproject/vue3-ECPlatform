import{a as b}from"./vue-router-3222bb99.js";import{P as y}from"./PaginationView-82b4b6d5.js";import{_ as P}from"./index-118448a2.js";import{aL as l,aB as c,L as r,M as t,F as h,aJ as D,Y as p,aY as i,bk as x,X as v}from"./@vue-1e6fac6c.js";import"./axios-aba6f0e0.js";import"./vue-axios-58a7c26f.js";import"./@ckeditor-b907fba5.js";import"./vue-d290faf7.js";import"./vee-validate-aae8f501.js";import"./@vee-validate-55db0f47.js";const{VITE_API_URL:g,VITE_API_PATH:m}={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_PATH:"kimi_project",BASE_URL:"/vue3-ECPlatform/final-mission/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},C=`${g}/api/${m}/products`,_=`${g}/api/${m}/cart`,L={data(){return{productsData:[],productsNum:0,page:{},productSelected:"",cartData:[],cartTotalPrice:0,isLoading:!1,isCheckout:!1}},methods:{getProductsData(a=1){this.isLoading=!1;const o=`${C}/?page=${a}`;this.$http.get(o).then(s=>{this.productsData=s.data.products,this.productsNum=this.productsData.length,this.page=s.data.pagination}).catch(s=>alert(s.message))},getCartData(){this.cartTotalPrice=0,this.$http.get(_).then(a=>{this.isLoading=!1,this.cartData=a.data.data.carts,this.cartData.forEach(o=>{this.cartTotalPrice+=o.total})}).catch(a=>alert(a.message))},addToCart(a){if(a=this.checkCartItemQty(a),!a)return;const o={product_id:a,qty:1};this.isLoading=!0,this.$http.post(_,{data:o}).then(s=>{alert(s.data.message),this.getCartData()}).catch(s=>alert(s.message))},checkCartItemQty(a){const o=this.cartData.findIndex(s=>s.product.id===a);if(o<0||this.cartData[o].qty<=10)return a;alert("選購數量已超過上限，若有大量採購需求請另洽")}},components:{Pagination:y,RouterLink:b},mounted(){this.getProductsData(),this.getCartData()}},k={class:"row justify-content-between"},I={class:"col-md-8 m-0"},T=t("h4",null,"世界菜譜",-1),$={class:"row"},w={class:"card"},E=["src","alt"],V={class:"card-body"},R={class:"card-title"},A={class:"card-text"},U={class:"badge bg-secondary bg-opacity-75 text-body-emphasis me-2"},S={class:"badge bg-secondary bg-opacity-75 text-body-emphasis me-2"},B={class:"badge bg-secondary bg-opacity-75 text-body-emphasis me-2"},N={class:"card-text"},j={class:"text-decoration-line-through fw-light me-3"},q={class:"fw-semibold"},F={class:"card-footer"},H={class:"d-flex gap-1"},M=["onClick"],O=t("div",{class:"col-md-3 m-0"},[t("h4",{class:"text-muted"},"尋找美味單"),t("span",{class:"text-muted"},"分類選單，先不做")],-1);function Q(a,o,s,Y,n,d){const u=l("RouterLink"),f=l("Pagination");return c(),r(h,null,[t("div",k,[t("div",I,[T,t("div",$,[(c(!0),r(h,null,D(n.productsData,e=>(c(),r("div",{class:"col-6 my-3",key:"productList"+e.id},[t("div",w,[t("img",{src:e.imageUrl,class:"card-img card-img-top rounded img-fluid object-fit-cover",alt:e.title,style:{height:"300px"}},null,8,E),t("div",V,[t("h5",R,i(e.title),1),t("p",A,[t("span",U,i(e.category),1),t("span",S,i(e.areaCategory),1),t("span",B,i(e.ingredientCategory),1)]),t("p",N,[t("span",j,"原價："+i(e.origin_price)+"元",1),t("span",q,"售價："+i(e.price)+"元",1)])]),t("div",F,[t("div",H,[p(u,{to:`product/${e.id}`,type:"button",class:"btn btn-sm btn-sm btn-outline-secondary w-100"},{default:x(()=>[v("查看產品細節 ")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-sm btn-sm btn-outline-warning w-100",onClick:J=>d.addToCart(e.id)}," 加入菜籃車 ",8,M)])])])]))),128))])]),O]),p(f,{ref:"pagination",pages:n.page,"get-per-page-data":d.getProductsData},null,8,["pages","get-per-page-data"])],64)}const ot=P(L,[["render",Q]]);export{ot as default};
