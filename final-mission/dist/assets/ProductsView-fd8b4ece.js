import{P as M}from"./PaginationView-82b4b6d5.js";import{M as k}from"./bootstrap-b937ab54.js";import{aB as l,L as a,M as e,aY as c,bm as i,bd as g,bc as y,F as h,aJ as b,b9 as w,J as p,aL as v,Y as S,an as D}from"./@vue-1e6fac6c.js";import{_ as P}from"./index-118448a2.js";import{D as x}from"./AdminDelDataModal-9dd09668.js";import{p as I,b as V,c as N,e as U}from"./admin-api-6c4fbbcb.js";import{p as A}from"./adminFormData-da5bf668.js";import"./@ckeditor-b907fba5.js";import"./vue-d290faf7.js";import"./axios-aba6f0e0.js";import"./vue-axios-58a7c26f.js";import"./vee-validate-aae8f501.js";import"./@vee-validate-55db0f47.js";import"./vue-router-3222bb99.js";const T={props:["productSelected","productIsNew","productCategories","addSideImages","saveProductChange","uploadImage"],data(){return{modal:""}},mounted(){this.modal=new k(this.$refs.modal,{keyboard:!1,backdrop:"static"})},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}}},B={class:"modal fade",id:"adminProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"adminProductModal",ref:"modal","aria-hidden":"true"},F={class:"modal-dialog modal-dialog-centered modal-xl",role:"document"},L={class:"modal-content"},J={class:"modal-header bg-warning bg-opacity-75"},O={class:"modal-title",id:"modalLabel"},Y=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),j={class:"modal-body"},z={class:"row"},E={class:"col-sm-8",id:"edit-content-from"},q={class:"mb-3"},G=e("label",{for:"title",class:"form-label"},"產品名稱",-1),H={class:"row"},K={class:"mb-3 col-md-6"},Q=e("label",{for:"main-category",class:"form-label"},"主分類",-1),R=e("option",{value:0,disabled:"",selected:""},"請選擇菜式",-1),W=["value"],X={class:"mb-3 col-md-6"},Z=e("label",{for:"unit",class:"form-label"},"單位",-1),$={class:"row"},ee={class:"mb-3 col-md-6"},te=e("label",{for:"area-category",class:"form-label"},"地域分類",-1),oe=e("option",{value:0,disabled:"",selected:""},"請選擇地域",-1),de=["value"],le={class:"mb-3 col-md-6"},ae=e("label",{for:"ingredient-category",class:"form-label"},"食材風格分類",-1),se=e("option",{value:0,disabled:"",selected:""},"請選擇食材",-1),ie=["value"],ce={class:"row"},ne={class:"mb-3 col-md-6"},re=e("label",{for:"origin_price",class:"form-label"},"原價",-1),ue={class:"mb-3 col-md-6"},me=e("label",{for:"price",class:"form-label"},"售價",-1),ge={class:"mb-3"},he=e("label",{for:"description",class:"form-label"},"內容描述",-1),_e={class:"mb-3"},pe=e("label",{for:"content",class:"form-label"},"說明內容",-1),be={class:"mb-3"},fe={class:"form-check"},ye=e("label",{class:"form-check-label",for:"is_enabled"},"是否上架",-1),ve={class:"col-sm-4"},Se={class:"mb-3"},Ue=e("label",{for:"imageUrl ",class:"form-label"},"主圖(請輸入網址或上傳圖片)",-1),Pe=["src"],Ce=e("hr",null,null,-1),Me={key:0},ke={class:"mb-3"},we=e("label",{for:"imageUrl",class:"form-label"},"副圖網址：",-1),De=["onUpdate:modelValue"],xe=["src"],Ie=["onClick"],Ve=e("hr",null,null,-1),Ne={key:0},Ae={class:"modal-footer"},Te={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"};function Be(s,o,t,r,u,m){return l(),a("div",B,[e("div",F,[e("div",L,[e("div",J,[e("h5",O,c(t.productIsNew?"新增產品":"編輯產品"),1),Y]),e("div",j,[e("div",z,[e("div",E,[e("div",q,[G,i(e("input",{id:"title","onUpdate:modelValue":o[0]||(o[0]=d=>t.productSelected.title=d),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[g,t.productSelected.title]])]),e("div",H,[e("div",K,[Q,i(e("select",{id:"main-category",class:"form-select","aria-label":"select main-category","onUpdate:modelValue":o[1]||(o[1]=d=>t.productSelected.category=d)},[R,(l(!0),a(h,null,b(t.productCategories.mainCategories,d=>(l(),a("option",{key:d,value:d},c(d),9,W))),128))],512),[[y,t.productSelected.category]])]),e("div",X,[Z,i(e("input",{id:"unit","onUpdate:modelValue":o[2]||(o[2]=d=>t.productSelected.unit=d),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[g,t.productSelected.unit]])])]),e("div",$,[e("div",ee,[te,i(e("select",{id:"area-category",class:"form-select","aria-label":"select area-category","onUpdate:modelValue":o[3]||(o[3]=d=>t.productSelected.areaCategory=d)},[oe,(l(!0),a(h,null,b(t.productCategories.areaCategories,d=>(l(),a("option",{key:d,value:d},c(d),9,de))),128))],512),[[y,t.productSelected.areaCategory]])]),e("div",le,[ae,i(e("select",{id:"ingredient-category",class:"form-select","aria-label":"select ingredient-category","onUpdate:modelValue":o[4]||(o[4]=d=>t.productSelected.ingredientCategory=d)},[se,(l(!0),a(h,null,b(t.productCategories.ingredientCategories,d=>(l(),a("option",{key:d,value:d},c(d),9,ie))),128))],512),[[y,t.productSelected.ingredientCategory]])])]),e("div",ce,[e("div",ne,[re,i(e("input",{id:"origin_price","onUpdate:modelValue":o[5]||(o[5]=d=>t.productSelected.origin_price=d),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[g,t.productSelected.origin_price,void 0,{number:!0}]])]),e("div",ue,[me,i(e("input",{id:"price","onUpdate:modelValue":o[6]||(o[6]=d=>t.productSelected.price=d),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[g,t.productSelected.price,void 0,{number:!0}]])])]),e("div",ge,[he,i(e("textarea",{id:"description","onUpdate:modelValue":o[7]||(o[7]=d=>t.productSelected.description=d),type:"text",class:"form-control",placeholder:"請輸入產品描述，ex:內容物"},`
                `,512),[[g,t.productSelected.description]])]),e("div",_e,[pe,i(e("textarea",{id:"content","onUpdate:modelValue":o[8]||(o[8]=d=>t.productSelected.content=d),type:"text",class:"form-control",placeholder:"請輸入說明內容"},`
                `,512),[[g,t.productSelected.content]])]),e("div",be,[e("div",fe,[i(e("input",{id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=d=>t.productSelected.is_enabled=d),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[w,t.productSelected.is_enabled]]),ye])])]),e("div",ve,[e("div",Se,[Ue,i(e("input",{"onUpdate:modelValue":o[10]||(o[10]=d=>t.productSelected.imageUrl=d),type:"text",class:"form-control my-2",placeholder:"請輸入圖片連結"},null,512),[[g,t.productSelected.imageUrl]]),e("input",{class:"form-control my-2",type:"file",name:"file-to-upload",onChange:o[11]||(o[11]=d=>t.uploadImage(d))},null,32),e("img",{class:"img-fluid rounded",src:t.productSelected.imageUrl},null,8,Pe),t.productSelected.imageUrl?(l(),a(h,{key:0},[Ce,Object.keys(t.productSelected).indexOf("imagesUrl")<0||!t.productSelected.imagesUrl.length?(l(),a("div",Me,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100 mt-1",onClick:o[12]||(o[12]=(...d)=>t.addSideImages&&t.addSideImages(...d))}," 新增副圖 ")])):p("",!0)],64)):p("",!0)]),Array.isArray(t.productSelected.imagesUrl)&&t.productSelected.imagesUrl.length?(l(),a(h,{key:0},[(l(!0),a(h,null,b(t.productSelected.imagesUrl,(d,_)=>(l(),a("div",{class:"mb-1",key:"sideimage"+_},[e("div",ke,[we,i(e("input",{"onUpdate:modelValue":f=>t.productSelected.imagesUrl[_]=f,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,De),[[g,t.productSelected.imagesUrl[_]]])]),e("img",{class:"img-fluid rounded",src:d},null,8,xe),t.productSelected.imagesUrl[t.productSelected.imagesUrl.length-1]?(l(),a("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100 m-1",onClick:f=>t.productSelected.imagesUrl.splice(_,1)}," 刪除本張副圖 ",8,Ie)):p("",!0),Ve]))),128)),t.productSelected.imagesUrl[t.productSelected.imagesUrl.length-1]?(l(),a("div",Ne,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100 m-1",onClick:o[13]||(o[13]=d=>t.productSelected.imagesUrl.push(""))}," 新增副圖 ")])):p("",!0)],64)):p("",!0)])])]),e("div",Ae,[e("button",Te,c(t.productIsNew?"取消新增":"取消編輯"),1),e("button",{type:"button",class:"btn btn-warning",onClick:o[14]||(o[14]=d=>t.saveProductChange(t.productSelected.id))},c(t.productIsNew?"新增產品":"儲存變更"),1)])])])],512)}const Fe=P(T,[["render",Be]]),Le={data(){return{productsData:[],haveProductsData:!1,productSelected:{imagesUrl:[],category:0,areaCategory:0,ingredientCategory:0},productIsNew:!0,productCategories:{},Pagination:{},currentPage:1,dataType:"產品"}},methods:{getProductsData(s=1){this.currentPage=s,this.$http.get(I(s)).then(o=>{this.productsData=o.data.products,this.haveProductsData=this.productsData.length>0,this.haveProductsData&&(this.Pagination=o.data.pagination)}).catch(o=>alert(o.response.data.message))},openManageModal(s,o){s==="add"?(this.productIsNew=!0,this.productSelected={imagesUrl:[],category:0,areaCategory:0,ingredientCategory:0},this.$refs.adminProductModal.openModal()):s==="edit"?(this.productSelected={...o},this.productIsNew=!1,this.$refs.adminProductModal.openModal()):s==="delete"&&(this.productSelected={...o},this.$refs.delProductModal.openModal())},uploadImage(s){const o=s.target.files[0],t=new FormData;t.append("file-to-upload",o),o&&this.$http.post(V,t).then(r=>{this.productSelected.imageUrl=r.data.imageUrl}).catch(r=>alert(r.message))},addSideImages(){this.productSelected.imagesUrl=[],this.productSelected.imagesUrl.push("")},saveProductChange(s){const o=this.productIsNew?"post":"put",t=this.productIsNew?N:U(s);this.$http[o](t,{data:this.productSelected}).then(r=>{alert(r.data.message),this.$refs.adminProductModal.hideModal(),this.getProductsData(this.currentPage)}).catch(r=>alert(r.message))},delProduct(s){this.$http.delete(U(s)).then(o=>{alert(o.data.message),this.$refs.delProductModal.hideModal(this.currentPage),this.getProductsData()}).catch(o=>alert(o.response.data.message))}},components:{Pagination:M,AdminProductModal:Fe,DelDataModal:x},mounted(){this.getProductsData(),this.productCategories={...A.productCategories}}},Je=e("h1",{class:"h3"},"產品管理",-1),Oe={class:"text-end my-4"},Ye={key:0},je={class:"table text-center"},ze=e("thead",null,[e("tr",null,[e("th",{width:"10"},"序號"),e("th",{width:"70"},"分類"),e("th",{width:"150"},"產品名稱"),e("th",{width:"120"},"售價"),e("th",{width:"120"},"上架裝態"),e("th",{width:"70"})])],-1),Ee=["onClick"],qe=e("i",{class:"bi bi-pen text-secondary fw-light"},null,-1),Ge=[qe],He=["onClick"],Ke=e("i",{class:"bi bi-trash3 text-danger fw-light"},null,-1),Qe=[Ke],Re={key:1},We=e("p",null,"目前尚未建立任何產品",-1),Xe=[We];function Ze(s,o,t,r,u,m){const d=v("Pagination"),_=v("AdminProductModal"),f=v("DelDataModal");return l(),a(h,null,[Je,e("div",Oe,[e("button",{type:"button",class:"btn btn-warning",onClick:o[0]||(o[0]=n=>m.openManageModal("add"))},"新增產品")]),u.haveProductsData?(l(),a("div",Ye,[e("table",je,[ze,e("tbody",null,[(l(!0),a(h,null,b(u.productsData,n=>(l(),a("tr",{key:n.id,class:"align-middle"},[e("td",null,c(n.num),1),e("td",null,c(n.category),1),e("td",null,c(n.title),1),e("td",null,c(n.price),1),e("td",{class:D({"text-success":n.is_enabled})},c(n.is_enabled?"啟用":"未啟用"),3),e("td",null,[e("button",{type:"button",class:"btn btn-sm",onClick:C=>m.openManageModal("edit",n)},Ge,8,Ee),e("button",{type:" button",class:"btn btn-sm",onClick:C=>m.openManageModal("delete",n)},Qe,8,He)])]))),128))])]),S(d,{ref:"pagination",pages:u.Pagination,"get-per-page-data":m.getProductsData},null,8,["pages","get-per-page-data"])])):(l(),a("div",Re,Xe)),S(_,{ref:"adminProductModal","product-Selected":u.productSelected,"product-is-new":u.productIsNew,"product-categories":u.productCategories,"add-side-images":m.addSideImages,"save-product-change":m.saveProductChange,"upload-image":m.uploadImage},null,8,["product-Selected","product-is-new","product-categories","add-side-images","save-product-change","upload-image"]),S(f,{ref:"delProductModal","data-Selected":u.productSelected,"del-data":m.delProduct,"data-Type":u.dataType},null,8,["data-Selected","del-data","data-Type"])],64)}const gt=P(Le,[["render",Ze]]);export{gt as default};
