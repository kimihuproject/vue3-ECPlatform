import{b as f}from"./vue-router-58c0efe5.js";import{_ as y}from"./index-5d8ccf7f.js";import{k as v,l as a,x as n,y as t,D as r,F as u,C as I,H as C,z as P,A as k,B as b}from"./@vue-26db76b7.js";import"./axios-08622986.js";import"./vue-axios-58a7c26f.js";import"./@fortawesome-076f127c.js";import"./vee-validate-b6132790.js";import"./@vee-validate-55db0f47.js";const{VITE_API_URL:p,VITE_API_PATH:m}={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_PATH:"kimi_project",BASE_URL:"/vue3-ECPlatform/week6/dist/",MODE:"production",DEV:!1,PROD:!0},x=`${p}/api/${m}/product`,h=`${p}/api/${m}/cart`,D={data(){return{product:{},cartData:[],cartTotalPrice:0,loadingItem:"",isLoading:!1,isCheckout:!1}},methods:{getProductInfo(){const{id:e}=this.$route.params;this.$http.get(`${x}/${e}`).then(o=>{this.product=o.data.product}).catch(o=>alert(o.message))},getCartData(){this.cartTotalPrice=0,this.$http.get(h).then(e=>{this.isLoading=!1,this.cartData=e.data.data.carts,this.cartData.forEach(o=>{this.cartTotalPrice+=o.total})}).catch(e=>alert(e.message))},addToCart(e){if(e=this.checkCartItemQty(e),!e)return;const o={product_id:e,qty:1};this.loadingItem=e,this.isLoading=!0,this.$http.post(h,{data:o}).then(i=>{alert(i.data.message),this.loadingItem="",this.getCartData()}).catch(i=>alert(i.message))},checkCartItemQty(e){const o=this.cartData.findIndex(i=>i.product.id===e);if(o<0||this.cartData[o].qty<=10)return e;alert("選購數量已超過上限，若有大量採購需求請另洽")}},components:{RouterLink:f},mounted(){this.getProductInfo(),this.getCartData()}},T={class:"h3"},L={class:"main"},A={class:"row"},E={class:"col-sm-8"},V={class:"row"},U=["src","alt"],w={class:"col-sm-4"},R={class:"d-flex flex-column justify-content-center",style:{height:"60vh"}},j={class:"list-unstyled"},B={class:"text-decoration-line-through fw-light"},N={class:"my-3"},H={class:"col-sm-3 me-3"},S=["src","alt"],q={class:"my-3 d-flex justify-content-end gap-1"};function F(e,o,i,O,s,_){var l,d;const g=v("RouterLink");return a(),n(u,null,[t("h2",T,r(s.product.title),1),t("div",L,[t("div",A,[t("div",E,[t("div",V,[t("img",{src:s.product.imageUrl,class:"rounded img-fluid object-fit-cover",alt:s.product.title,style:{height:"60vh"}},null,8,U)])]),t("div",w,[t("div",R,[t("div",null,[t("ul",j,[t("li",null,"菜式風格："+r(s.product.category),1),t("li",null,"地域風味："+r(s.product.areaCategory),1),t("li",null,"食材主題："+r(s.product.ingredientCategory),1),t("li",null,"份量單位："+r(s.product.unit),1),t("li",null,"內容物："+r(s.product.content),1),t("li",B," 原價："+r(s.product.origin_price)+"元 ",1),t("li",null,"售價："+r(s.product.price)+"元",1)])])])])]),t("div",N,[t("p",null,r(s.product.description),1)]),Array.isArray((l=s.product)==null?void 0:l.imagesUrl)&&((d=s.product)!=null&&d.imagesUrl.length)?(a(!0),n(u,{key:0},I(s.product.imagesUrl,c=>(a(),n("div",{class:"row my-3",key:"side-image"+c},[t("div",H,[t("img",{src:c,class:"rounded img-fluid object-fit-cover img-thumbnail",alt:s.product.title,style:{height:"40vh"}},null,8,S)])]))),128)):C("",!0)]),t("div",q,[P(g,{to:"/productsList",type:"button",class:"btn btn-outline-secondary btn-sm"},{default:k(()=>[b("回產品列表 ")]),_:1}),t("button",{type:"button",class:"btn btn-outline-warning btn-sm",onClick:o[0]||(o[0]=c=>_.addToCart(s.product.id))}," 加入菜籃車 ")])],64)}const Y=y(D,[["render",F]]);export{Y as default};
